{% extends "base.html" %}
{% load staticfiles %}
{% block content %}

        <div class="row">  
                <div class='col-md-2'></div>
                <div class="col-md-8">
                        <div class="map-responsive" id="mapa" style="border-radius:1%;"></div>
                </div>
                <div class='col-md-2'></div>
        </div>
        <div class="row">
            {% if republicas %}
                {% for republica in republicas %}
                    <div class="col-md-8 div-arredondada mb-2 mt-2 ml-2 mr-2">
                        <a href="{% url 'perfil-republica' republica.id %}">
                            <label>Nome da república:</label>
                            {{republica.nome}}
                        </a><br/>
                        <label>Gênero aceito:</label>
                        {{republica.genero}}<br/>
                        <label>Quantidade de vagas:</label>
                        {{republica.qtd_vagas}}<br/>
                        <label>Tipo do imóvel:</label>
                        {% if republica.tipo_imovel == 'AP'%} Apartamento {% else %} Casa {% endif %}
                    </div>
                {% endfor %}    
            {% else %}
                    <p>Não há repúblicas próximas do seu local.</p>
            {% endif %}
        </div>

    <!-- Maps API Javascript -->
    <script src="https://maps.google.com/maps/api/js?key=AIzaSyASfM8yMN_z1DVkTFFAKRp1aigtWxjOi6U"></script>
    <!-- jQuery (necessario para os plugins Javascript do Bootstrap) -->
    <script type="text/javascript" src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'bootstrap-4.1.3/dist/js/bootstrap.min.js' %}"></script>
    <script type="text/javascript">

        var map;
 
        function initialize() {
            var latlng = new google.maps.LatLng(-18.8800397, -47.05878999999999);
         
            var options = {
                zoom: 5,
                center: latlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            google.maps.event.addDomListener(window, "resize", function() {
                var center = map.getCenter();
                google.maps.event.trigger(map, "resize");
                map.setCenter(center); 
            });
            
            var input = document.getElementById('id_endereco');
            map = new google.maps.Map(document.getElementById("mapa"), options);
        }
        
        google.maps.event.addDomListener(window,'load',initialize)

        function carregarPontos() {
 
                $.getJSON("{% static 'json/pontos.json' %}", function(pontos) {
                console.log(pontos)
                    $.each(pontos, function(index, ponto) {
             
                        var marker = new google.maps.Marker({
                            position: new google.maps.LatLng(ponto.Latitude, ponto.Longitude),
                            title: '',
                            map: map
                        });
             
                    });
             
                });
             
            }
            google.maps.event.addDomListener(window,'load',carregarPontos)

        </script>
   {% endblock %}
